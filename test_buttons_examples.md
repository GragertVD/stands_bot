# üß™ –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫ VK Teams

## üìù –¢–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### 1. –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ —á–µ—Ä–µ–∑ N8N webhook

```bash
curl -X POST http://localhost:8000/api/webhook \
  -H "Content-Type: application/json" \
  -d '{
    "chat_id": "v.graget@vkteam.ru",
    "message": "üéØ –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
    "message_type": "text",
    "buttons": [
      {
        "text": "‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",
        "callback_data": "confirm_action"
      },
      {
        "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
        "callback_data": "cancel_action"
      },
      {
        "text": "üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è",
        "url": "https://teams.vk.com/botapi/tutorial/"
      }
    ]
  }'
```

### 2. –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏

```bash
curl -X POST http://localhost:8000/api/send-message \
  -H "Content-Type: application/json" \
  -d '{
    "chat_id": "v.graget@vkteam.ru",
    "message": "üè™ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –º–∞–≥–∞–∑–∏–Ω!\n\n–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ç–æ–≤–∞—Ä–æ–≤:",
    "buttons": [
      {"text": "üëï –û–¥–µ–∂–¥–∞", "callback_data": "category_clothes"},
      {"text": "üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", "callback_data": "category_electronics"},
      {"text": "üìö –ö–Ω–∏–≥–∏", "callback_data": "category_books"},
      {"text": "üè† –î–æ–º –∏ —Å–∞–¥", "callback_data": "category_home"},
      {"text": "üõí –ö–æ—Ä–∑–∏–Ω–∞", "callback_data": "show_cart"},
      {"text": "üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞", "callback_data": "support"}
    ]
  }'
```

### 3. –û–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```bash
curl -X POST http://localhost:8000/api/webhook \
  -H "Content-Type: application/json" \
  -d '{
    "chat_id": "v.graget@vkteam.ru",
    "message": "‚≠ê –ö–∞–∫ –≤—ã –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç–µ –Ω–∞—à—É –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –∫–Ω–æ–ø–æ–∫?",
    "buttons": [
      {"text": "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –û—Ç–ª–∏—á–Ω–æ!", "callback_data": "rating_5"},
      {"text": "‚≠ê‚≠ê‚≠ê‚≠ê –•–æ—Ä–æ—à–æ", "callback_data": "rating_4"},
      {"text": "‚≠ê‚≠ê‚≠ê –ù–æ—Ä–º–∞–ª—å–Ω–æ", "callback_data": "rating_3"},
      {"text": "‚≠ê‚≠ê –ü–ª–æ—Ö–æ", "callback_data": "rating_2"},
      {"text": "‚≠ê –£–∂–∞—Å–Ω–æ", "callback_data": "rating_1"}
    ]
  }'
```

### 4. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

```bash
curl -X POST http://localhost:8000/api/send-message \
  -H "Content-Type: application/json" \
  -d '{
    "chat_id": "v.graget@vkteam.ru",
    "message": "üÜò –¶–µ–Ω—Ç—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏\n\n–ö–∞–∫ –º—ã –º–æ–∂–µ–º –≤–∞–º –ø–æ–º–æ—á—å?",
    "buttons": [
      {"text": "üêõ –°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ", "callback_data": "report_bug"},
      {"text": "üí° –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–¥–µ—é", "callback_data": "suggest_feature"},
      {"text": "‚ùì –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å", "callback_data": "ask_question"},
      {"text": "üìû –°–≤—è–∑–∞—Ç—å—Å—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º", "callback_data": "contact_operator"},
      {"text": "üìñ –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π", "url": "https://help.example.com"},
      {"text": "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", "callback_data": "main_menu"}
    ]
  }'
```

## üîÑ –û–∂–∏–¥–∞–µ–º—ã–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç –±–æ—Ç–∞

### –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:
```json
{
  "status": "accepted",
  "chat_id": "v.graget@vkteam.ru",
  "message": "üéØ –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
  "message_type": "text",
  "timestamp": "2025-09-28T16:30:15.123456",
  "message_length": 20
}
```

### –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:
```
üì• –ü–æ–ª—É—á–µ–Ω webhook –æ—Ç N8N –¥–ª—è —á–∞—Ç–∞ v.graget@vkteam.ru: üéØ –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:...
üì§ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å 3 –∫–Ω–æ–ø–∫–∞–º–∏
üîò –° –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π: {'inlineKeyboard': [[{'text': '‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å', 'callbackData': 'confirm_action'}], ...]}
‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –£–°–ü–ï–®–ù–û –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —á–∞—Ç v.graget@vkteam.ru
‚úÖ Webhook —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ —á–∞—Ç v.graget@vkteam.ru
```

## üéÆ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –ö–æ–º–∞–Ω–¥–∞ /start
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –º–µ–Ω—é:
```
–ü—Ä–∏–≤–µ—Ç! –Ø VK Teams –±–æ—Ç —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π N8N –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–Ω–æ–ø–æ–∫.

–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:

[‚ùì –°–ø—Ä–∞–≤–∫–∞] [üìä –°—Ç–∞—Ç—É—Å]
[üß™ –¢–µ—Å—Ç —ç—Ö–æ]
```

### –ö–æ–º–∞–Ω–¥–∞ /status  
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å—Ç–∞—Ç—É—Å:
```
ü§ñ –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞: –ê–∫—Ç–∏–≤–µ–Ω
üìä –ê–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤: 5
üîó API URL: https://api.internal.myteam.mail.ru/bot/v1
üì° N8N Webhook: ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω
üéØ –û–∫—Ä—É–∂–µ–Ω–∏–µ: production

[üîÑ –û–±–Ω–æ–≤–∏—Ç—å] [‚ùì –°–ø—Ä–∞–≤–∫–∞]
[üß™ –¢–µ—Å—Ç —ç—Ö–æ]
```

## üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É, —Å–∏—Å—Ç–µ–º–∞:

1. **–õ–æ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ**:
```
üîò –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –æ—Ç –í–ª–∞–¥–∏–º–∏—Ä –ì—Ä–∞–≥–µ—Ä—Ç –≤ —á–∞—Ç–µ v.graget@vkteam.ru: confirm_action
```

2. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ N8N**:
```json
{
  "timestamp": "2025-09-28T16:30:45.123456",
  "source": "vk_teams", 
  "event_type": "callback_query",
  "data": {
    "callback_data": "confirm_action",
    "chat_id": "v.graget@vkteam.ru",
    "user_name": "–í–ª–∞–¥–∏–º–∏—Ä –ì—Ä–∞–≥–µ—Ä—Ç",
    "user_id": "v.graget@vkteam.ru",
    "query_id": "unique_query_id_123"
  }
}
```

3. **–í—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ** —Å–æ–≥–ª–∞—Å–Ω–æ callback_data
4. **–û—Ç–≤–µ—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**:
```
‚úÖ –î–µ–π—Å—Ç–≤–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ!
```

## üåê API Endpoints

### –ù–æ–≤—ã–µ endpoints:
- `POST /api/webhook` - –ø—Ä–∏–µ–º webhook —Å –∫–Ω–æ–ø–∫–∞–º–∏ –æ—Ç N8N
- `POST /api/send-message` - –ø—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∫–Ω–æ–ø–∫–∞–º–∏  
- `GET /api/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–Ω–æ–ø–∫–∞—Ö

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
curl -s http://localhost:8000/health | jq .

# –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
curl -s http://localhost:8000/api/stats | jq .

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
curl -s http://localhost:8000/docs
```

## üé® –§–æ—Ä–º–∞—Ç—ã VK Teams

–°–æ–≥–ª–∞—Å–Ω–æ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ VK Teams](https://teams.vk.com/botapi/tutorial/), –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:

### Callback –∫–Ω–æ–ø–∫–∏:
```json
{
  "text": "–ö–Ω–æ–ø–∫–∞",
  "callbackData": "action_name"
}
```

### URL –∫–Ω–æ–ø–∫–∏:
```json
{
  "text": "–°—Å—ã–ª–∫–∞", 
  "url": "https://example.com"
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã:
```json
{
  "inlineKeyboardMarkup": {
    "inlineKeyboard": [
      [{"text": "–ö–Ω–æ–ø–∫–∞ 1", "callbackData": "btn1"}],
      [{"text": "–ö–Ω–æ–ø–∫–∞ 2", "callbackData": "btn2"}]
    ]
  }
}
```

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏ VK Teams!** üéâ
